<!doctype html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ovo&family=Qwitcher+Grypen&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="../anexos/icons/logoTit.png">
    <link rel="stylesheet" href="../estilo.css">
    <title>UB Social</title>
</head>
<body>
<div class="container-fluid">


    <div class="row">
        <div class="col-sm-12" id="menu">
            <nav class="navbar fixed-top navbar-expand-lg navbar-light bg-light shadow">
                <div class="container-fluid">
                    <a id="serifada" class="navbar-brand" href="../index.html"><img src="../anexos/icons/logo.png" id="logo"> UB Social</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav">
                            <li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
                            <li class="nav-item"><a class="nav-link" href="../contato.html">Contato</a></li>
                            <li class="nav-item"><a class="nav-link" href="../livros.html">Livros</a></li>
                        </ul>
                    </div>
                </div>
            </nav>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-12" id="titulo1">
            <h1 id="serifada">Automatizações com Python</h1>
            <h6><strong>Automatização de ambientes com Python 3</strong></h6>
            <a href="../index.html" class="btn btn-link" id="btnLink">Voltar</a>
        </div>

        <div class="col-sm-12">
            <h4>Ambiente e materiais</h4>
            <a href="https://github.com/ubsocial/automatizacaoPython" class="btn btn-link" id="btnLink" target="_blank">Github do projeto</a>
            <p id="textoPost">Instalar editor Jupyter Notebook:</p>
            <ol>
                <li>sudo apt update && sudo apt upgrade</li>
                <li>sudo apt install python3-pip python3-dev</li>
                <li>sudo -H pip3 install --upgrade pip</li>
                <li>sudo -H pip3 install virtualenv</li>
                <li>mkdir notebook && cd notebook</li>
                <li>virtualenv jupyterenv</li>
                <li>source jupyterenv/bin/activate</li>
                <li>pip install jupyter</li>
                <li>(Execução) source jupyterenv/bin/activate && jupyter notebook
                    <ul>
                        <li>'ctrl+c' no Bash para parar o server jupyter</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="col-sm-12">
            <br><h4>===== AUTOMATIZAÇÃO DE SISTEMAS E PROCESSOS =====</h4>
            <p id="textoPost">Automatizar sistema de vendas, cujo diariamente envia email para diretoria, informando faturamento e quantidade de produtos vendidos no dia anterior. Automaticamente, exportar relatório de vendas e anexá-lo em email para a diretoria, enviando-o.</p>
            <ol>
                <li>Entrar no sistema da empresa, onde o mesmo disponibilizará (Exportará) relatório base de vendas do dia anterior (<a href="https://drive.google.com/drive/folders/149xknr9JvrlEnhNWO49zPcw0PW5icxga?usp=sharing" target="_blank">Link aqui</a>);</li>
                <li>Baixar base de vendas e importá-la ao Python ;</li>
                <li>Calcular faturamento e quantidade de produtos vendidos;</li>
                <li>Enviar email para diretoria (seugmail+diretoria@gmail.com).</li>
            </ol>

            <br><h5>Importar Libraries</h5>
<small><pre><code>
<span class="text-muted">#pyautogui e pyperclip automatizam mouse, display e teclado da máquina</span>
!pip install pyautogui
!pip install pyperclip

import pyautogui
import pyperclip
import time

pyautogui.PAUSE = 1 <span class="text-muted">#Delay, em segundos, entre comandos</span>
</code></pre></small>
            
            <br><h5>Entrar no sistema</h5>
<small><pre><code>
pyautogui.hotkey("ctrl","t") <span class="text-muted">#Combinação/Atalho de teclas, abrir nova aba</span>
pyperclip.copy("https://drive.google.com/drive/folders/149xknr9JvrlEnhNWO49zPcw0PW5icxga?usp=sharing")
pyautogui.hotkey("ctrl","v")
pyautogui.press("enter") <span class="text-muted">#Aperta tecla 'enter'. 'click' clica com o mouse em algum ponto da tela. 'write' escreve na tela (Ao mandar python escrever URL, ele não incluirá o '?', pois é caractere especial)</span>

time.sleep(5)
</code></pre></small>

            <br><h5>Navegar até relatório (Entrar na pasta Exportar)</h5>
<small><pre><code>
pyautogui.click(x=516,y=316,clicks=2)
time.sleep(2)
</code></pre></small>

            <br><h5>Baixar relatório</h5>
<small><pre><code>
pyautogui.click(x=510,y=378)
pyautogui.click(x=1108,y=176)
pyautogui.click(x=951,y=719)
time.sleep(5)
</code></pre></small>

            <br><h5>Calcular indicadores</h5>
<small><pre><code>
<span class="text-muted">#pandas é usado para abrir bases de dados com Python</span>
import pandas as pd

tabela = pd.read_excel(r"C://Users/alonp/Downloads/Vendas - Dez.xlsx") <span class="text-muted">#Confira a URI de acordo com sua máquina</span>
display(tabela)

faturamento = tabela["Valor Final"].sum()
quantidade = tabela["Quantidade"].sum()
</code></pre></small>

            <br><h5>Enviar email (Gmail)</h5>
<small><pre><code>
<span class="text-muted">#Entrar no email</span>
pyautogui.hotkey("ctrl","t")
pyperclip.copy("https://mail.google.com/mail/u/0/#inbox")
pyautogui.hotkey("ctrl","v")
pyautogui.press("enter")
time.sleep(5)

<span class="text-muted">#Enviar resultado por email</span>
pyautogui.click(x=109,y=183)

pyautogui.write("ubsocial@gmail.com") <span class="text-muted">#Informar email válido</span>
pyautogui.press("tab") <span class="text-muted">#Selecionar email</span>
pyautogui.press("tab") <span class="text-muted">#Pular pro campo assunto</span>
pyperclip.copy("Relatório de Vendas")
pyautogui.hotkey("ctrl", "v") <span class="text-muted">#Escrever assunto</span>
pyautogui.press("tab") <span class="text-muted">#Pular pro corpo do email</span>

texto = f"""
Prezados, bom dia

O faturamento de ontem foi de: R${faturamento:,.2f}
A quantidade de produtos foi de: {quantidade:,}

Cordialmente,
UB Social"""

pyperclip.copy(texto)
pyautogui.hotkey("ctrl","v")

<span class="text-muted">#Clicar no botão enviar (Ou apertar ctrl+enter)</span>
pyautogui.hotkey("ctrl","enter")
</code></pre></small>

            <br><h5>Descobrir posição de click</h5>
<small><pre><code>
<span class="text-muted">#Cada display é específico, portanto pode-se modificar os valores de posição de click nos dados acima</span>
time.sleep(5)
pyautogui.position()
</code></pre></small>
        </div>
    </div>


<!--Rodapé-->
<div class="row">
    <div class="col-sm-12 text-center" id="rodape">
        <p id="serifada">Elaborado por Mateus Schwede<br><small class="text-muted">ubsocial.github.io</small></p>
    </div>
</div>

</div>
</body>
</html>